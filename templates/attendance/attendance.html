<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <button id="getLocation" type="button">현재 위치 갱신</button>
    <div id="map" style="width:500px; height: 500px;display: block;"></div>
    <form id="" action="" method="POST">
        {% csrf_token %}
        <input type="hidden" id="location_lat" name="location_lat" value="">
        <input type="hidden" id="location_lng" name="location_lng" value="">
        <button type="submit">전송</button>
    </form>
    <script>
      (function (){
        let map, infoWindow; window.initMap = function () {
          map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: 37.517565, lng: 127.018110},
            zoom: 18
           });
           infoWindow = new google.maps.InfoWindow({map: map});
           infoWindow.setContent('현재 위치');
          };
          function successCallback(position) {
            let pos = {
              lat: position.coords.latitude, lng: position.coords.longitude
             };
              infoWindow.setPosition(pos);
              map.setCenter(pos);
              alert("위치 확인 완료!");
              document.getElementById('location_lat').value = pos.lat;
              document.getElementById('location_lng').value = pos.lng;
            } function errorCallback(error) { alert("Error: " + error.message);
          }
          document.getElementById("getLocation").onclick = function () {
            navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
          };
        }());
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key={{google_map_api_secret}}"
            async="" defer=""></script>
</body>
</html>
